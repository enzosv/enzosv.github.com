function init(){loadContent();width=window.innerWidth-15;height=window.innerHeight-45;aistupidity=150;delta=0;projectileRadius=height*width/3e5;playerRadius=projectileRadius*10;enemyRadius=projectileRadius*12;maxEnemies=5;p1=new Player(1);p2=new Player(-1);p2.center.x=width-1.5*playerRadius;textYPos=height/32;text1XPos=p1.center.x-playerRadius*1.4;text2XPos=p2.center.x-playerRadius*1.6;drawCanvas()}function loadContent(){humanImage=new Image;humanImage.src="Images/Asteroids/humanTop.png";alienImage=new Image;alienImage.src="Images/Asteroids/alienTop.png";humanEnemyImage=new Image;humanEnemyImage.src="Images/Asteroids/humanEnemy.png";alienEnemyImage=new Image;alienEnemyImage.src="Images/Asteroids/alienEnemy.png";hProj1=new Image;hProj1.src="Images/Asteroids/humanProjectile1.png";hProj2=new Image;hProj2.src="Images/Asteroids/humanProjectile2.png";hProj3=new Image;hProj3.src="Images/Asteroids/humanProjectile3.png";aProj1=new Image;aProj1.src="Images/Asteroids/alienProjectile1.png";aProj2=new Image;aProj2.src="Images/Asteroids/alienProjectile2.png";aProj3=new Image;aProj3.src="Images/Asteroids/alienProjectile3.png"}function drawCanvas(){canvas=document.createElement("canvas");canvas.setAttribute("id","canvas");canvas.setAttribute("style","border: 1px solid white;");canvas.addEventListener("touchstart",touch,false);canvas.width=width;canvas.height=height;document.body.appendChild(canvas);ctx=canvas.getContext("2d");window.addEventListener("keyup",function(e){Key.onKeyup(e)},false);window.addEventListener("keydown",function(e){Key.onKeydown(e)},false);ctx.font="normal "+12+"px Lucida Console";prepare()}function touch(e){this.x=e.changedTouches[0].pageX-canvas.offsetLeft;if(this.x<width/2){if(this.x<width/4){this.y=e.changedTouches[0].pageY-canvas.offsetTop;if(this.y<height/2){p1.up=true;p1.down=false;p1.aible=false}else if(this.y>height/2){p1.up=false;p1.down=true;p1.aible=false}}else{p1.firing=true}}else{if(this.x>width*3/4){this.y=e.changedTouches[0].pageY-canvas.offsetTop;if(this.y<height/2){p2.up=true;p2.down=false;p2.aible=false}else if(this.y>height/2){p2.up=false;p2.down=true;p2.aible=false}}else{p2.firing=true}}canvas.addEventListener("touchend",touchup,false)}function touchup(e){this.x=e.changedTouches[0].pageX-canvas.offsetLeft;if(this.x<width/2){p1.up=false;p1.down=false;p1.firing=false}if(this.x>width/2){p2.up=false;p2.down=false;p2.firing=false}}function control(){if(Key.isDown(Key.W)){p1.move("up");p1.aible=false}else if(Key.isDown(Key.S)){p1.move("down");p1.aible=false}if(Key.isDown(Key.D)){p1.firing=true;p1.aible=false;delete Key.pressed[Key.D]}if(Key.isDown(Key.UP)){p2.move("up");p2.aible=false}else if(Key.isDown(Key.DOWN)){p2.move("down");p2.aible=false}if(Key.isDown(Key.LEFT)){p2.firing=true;p2.aible=false;delete Key.pressed[Key.LEFT]}}function touchControl(){if(p1.up){p1.move("up")}else if(p1.down){p1.move("down")}if(p2.up){p2.move("up")}else if(p2.down){p2.move("down")}}function vector(e,t){this.x=e;this.y=t;this.add=function(e){this.x+=e.x;this.y+=e.y};this.sub=function(e){this.x-=e.x;this.y-=e.y};this.mul=function(e){this.x*=e;this.y*=e};this.div=function(e){this.x/=e;this.y/=e};this.distance=function(e){return Math.sqrt((e.x-this.x)*(e.x-this.x)+(e.y-this.y)*(e.y-this.y))};this.zero=function(){return new vector(0,0)};this.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)};this.normalize=function(){}}function Enemy(e){this.maxLife=20;this.life=this.maxLife;this.radius=enemyRadius;this.center=new vector(width/2-this.radius,Math.random()*height);this.speed=1;this.opponent=e;this.lvl=1;if(e.number===1){this.image=alienEnemyImage}else{this.image=humanEnemyImage}this.direction=e.number;this.draw=function(){ctx.drawImage(this.image,this.center.x-this.radius,this.center.y-this.radius,this.radius*2,this.radius*2)};this.move=function(){this.center.x-=this.direction*this.speed};this.collide=function(){if(this.center.y-this.radius<this.opponent.center.y+playerRadius||this.center.y+this.radius>this.opponent.center.y-playerRadius){if(this.center.distance(this.opponent.center)<=this.radius+playerRadius){this.opponent.die();this.setPosition()}}};this.update=function(){this.move();this.boundWall();this.collide()};this.setPosition=function(){this.center=new vector(width/2-this.radius,Math.random()*height);this.life=this.maxLife;this.opponent.findClosest()};this.getHit=function(e){this.life-=e;if(this.life<=0){this.setPosition();this.opponent.addScore(1);this.opponent.addExp(this.lvl)}};this.boundWall=function(){if(this.center.y+this.radius>=height){this.setPosition()}else if(this.center.y-this.radius<0){this.setPosition()}if(this.center.x+this.radius>width){this.setPosition()}else if(this.center.x-this.radius<0){this.setPosition()}};this.lvlUp=function(){this.lvl++;this.radius+=this.radius/10;this.maxLife+=5;this.speed+=.2}}function Projectle(e){this.center=new vector(0,0);this.active=false;this.direction=e.number;this.owner=e;this.speed=8;this.damage=10;if(e.number===1){this.image=hProj1}else{this.image=aProj1}this.draw=function(){if(this.active){ctx.drawImage(this.image,this.center.x-projectileRadius,this.center.y-projectileRadius,projectileRadius*2,projectileRadius*2)}};this.move=function(){this.center.x+=this.direction*this.speed};this.boundWall=function(){if(this.center.y+projectileRadius>=height){this.active=false}else if(this.center.y-projectileRadius<0){this.active=false}if(this.direction===1&&this.center.x+projectileRadius>width/2-enemyRadius){this.active=false}else if(this.direction===-1&&this.center.x-projectileRadius<width/2+enemyRadius){this.active=false}};this.shoot=function(){if(this.direction===1)this.center=new vector(this.owner.center.x+projectileRadius+playerRadius,this.owner.center.y);else this.center=new vector(this.owner.center.x-projectileRadius-playerRadius,this.owner.center.y);this.active=true};this.collide=function(){for(x=0;x<this.owner.enemies.length;x++){var e=this.owner.enemies[x];if(this.center.y>e.center.y-e.radius&&this.center.y<e.center.y+e.radius){if(this.center.distance(e.center)<projectileRadius+e.radius){e.getHit(this.damage);this.active=false}}}};this.update=function(){if(this.active){this.move();this.collide();this.boundWall()}}}function Player(e){if(e===1){this.image=humanImage}else{this.image=alienImage}this.speed=height/aistupidity;this.number=e;this.center=new vector(1.5*playerRadius,height/2-playerRadius);this.aible=true;this.up=false;this.down=false;this.score=0;this.maxProjectiles=50;this.lastLeveled=-1;this.exp=0;this.lvl=1;this.cooldownSpeed=0;this.deaths=0;this.maxTimer=20;this.projectiles=[];this.enemies=[];this.enemies[0]=new Enemy(this);this.closest=this.enemies[0];this.shootTimer=0;for(var t=0;t<this.maxProjectiles;t++){this.projectiles[t]=new Projectle(this)}this.draw=function(){ctx.drawImage(this.image,this.center.x-playerRadius,this.center.y-playerRadius,playerRadius*2,playerRadius*2);for(var e=0;e<this.maxProjectiles;e++){this.projectiles[e].draw()}for(var e=0;e<this.enemies.length;e++){this.enemies[e].draw()}};this.boundWall=function(){if(this.center.y+playerRadius>=height)this.center.y=height-playerRadius;else if(this.center.y-playerRadius<0)this.center.y=playerRadius};this.move=function(e){if(e==="up")this.center.y-=this.speed;else if(e==="down")this.center.y+=this.speed};this.fire=function(){if(this.shootTimer<=0){this.firing=false;this.shootTimer=this.maxTimer-this.cooldownSpeed;for(var t=0;t<this.maxProjectiles;t++){if(!this.projectiles[t].active){this.projectiles[t].shoot(e);break}}}};this.cooldown=function(){if(this.shootTimer>0)this.shootTimer--};this.findClosest=function(){var e=this.center.distance(this.closest.center);for(var t=0;t<this.enemies.length;t++){var n=this.center.distance(this.enemies[t].center);if(n>playerRadius+this.enemies[t].radius&&n<=e){this.closest=this.enemies[t];e=this.center.distance(this.closest)}}};this.ai=function(){if(this.aible){if(this.center.y>this.closest.center.y+this.speed+1){this.move("up")}else if(this.center.y<this.closest.center.y-this.speed-1){this.move("down")}else{this.fire()}}};this.update=function(){if(this.firing){this.fire()}for(var e=0;e<this.maxProjectiles;e++){this.projectiles[e].update()}for(var e=0;e<this.enemies.length;e++){this.enemies[e].update()}this.ai();this.boundWall();this.cooldown()};this.addScore=function(e){this.score+=e;if(this.score%10===0){if(this.enemies.length<maxEnemies)this.enemies.push(new Enemy(this));else{this.lastLeveled++;if(this.lastLeveled===maxEnemies){this.lastLeveled=0}this.enemies[this.lastLeveled].lvlUp()}}};this.lvlUp=function(){this.lvl++;this.speed+=this.speed/15;this.cooldownSpeed+=.2;for(var e=0;e<this.projectiles.length;e++){this.projectiles[e].damage+=this.projectiles[e].damage/5}if(this.lvl===10){for(var e=0;e<this.projectiles.length;e++){if(this.number===1)this.projectiles[e].image=hProj2;else this.projectiles[e].image=aProj2}}else if(this.lvl===20){for(var e=0;e<this.projectiles.length;e++){if(this.number===1)this.projectiles[e].image=hProj3;else this.projectiles[e].image=aProj3}}};this.addExp=function(e){this.exp+=e*30/this.lvl;if(this.exp>=this.lvl*100){this.lvlUp()}};this.die=function(){this.center.y=height/2-playerRadius;if(!this.aible){this.deaths++;this.speed-=this.speed/10;this.cooldownSpeed-=.2;for(var e=0;e<this.projectiles.length;e++){this.projectiles[e].damage-=this.projectiles[e].damage/10}}}}function prepare(){ctx.fillStyle="rgb(0,0,0)";ctx.fillRect(0,0,width,height);ctx.fillStyle="rgb(255,255,255)";update()}function update(){p2.update();p1.update();control();touchControl();draw()}function draw(){p1.draw();p2.draw();ctx.fillText("Score: "+p1.score,text1XPos,textYPos);ctx.fillText("Lvl: "+p1.lvl+" Exp: "+(p1.exp-(p1.lvl-1)*100),text1XPos,textYPos+12);ctx.fillText("Deaths: "+p1.deaths,text1XPos,textYPos+24);ctx.fillText("Score: "+p2.score,text2XPos,textYPos);ctx.fillText("Lvl: "+p2.lvl+" Exp: "+(p2.exp-(p2.lvl-1)*100),text2XPos,textYPos+12);ctx.fillText("Deaths: "+p2.deaths,text2XPos,textYPos+24);ctx.fillText("Instructions Keyboard: ",16,height-36);ctx.fillText("Shoot: D, Left Arrow",16,height-24);ctx.fillText("Move: W, S, Up, Down",16,height-12);ctx.fillText("Instructions Touch: ",width-160,height-36);ctx.fillText("Shoot: Near Center",width-160,height-24);ctx.fillText("Move: Above/Below half",width-160,height-12);requestAnimFrame(prepare)}var canvas;var ctx;var width;var height;var aistupidity;var p1;var p2;var projectileRadius;var playerRadius;var humanImage;var alienImage;var humanEnemyImage;var alienEnemyImage;var hProj1;var hProj2;var hProj3;var aProj1;var aProj2;var aProj3;var maxEnemies;var textYPos;var text1XPos;var text2XPos;var Key={pressed:{},UP:38,DOWN:40,LEFT:37,RIGHT:39,W:87,S:83,A:65,D:68,ESC:27,isDown:function(e){return this.pressed[e]},onKeydown:function(e){this.pressed[e.keyCode]=true},onKeyup:function(e){delete this.pressed[e.keyCode]}};requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)}}()