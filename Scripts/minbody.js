function init(){width=window.innerWidth-30;height=window.innerHeight-45;damping=.5;radius=height/200;diameter=height/100;lengthLimit=radius*10;speed=width*2/height;b=[];delta=0;old=Date.now();fontWidth=width/2-height/18;image=new Image;image.src="Images/nbody.png";vec=0;length=0;drawCanvas()}function drawCanvas(){canvas=document.createElement("canvas");canvas.width=width;canvas.height=height;canvas.setAttribute("style","border: 1px solid white;");document.body.appendChild(canvas);ctx=canvas.getContext("2d");ctx.fillStyle="rgba(255,255,255, 1)";ctx.font="normal "+12+"px Lucida Console";limit=prompt("How many particles?");for(var e=0;e<limit;e++){b[e]=new Ball}prepare()}function Ball(){this.pos=new Vector(Math.random()*width,Math.random()*height);this.vel=new Vector(Math.random()*(speed+speed+1)-speed,Math.random()*(speed+speed+1)-speed);this.acl=new Vector(0,0);this.addForce=function(){this.vel.add(this.acl);this.acl.zero()};this.move=function(){this.addForce();this.pos.add(this.vel);if(this.pos.x+diameter>width){this.pos.x=width-diameter;this.vel.x*=-damping}else if(this.pos.x<0){this.pos.x=0;this.vel.x*=-damping}if(this.pos.y+diameter>height){this.pos.y=height-diameter;this.vel.y*=-damping}else if(this.pos.y<0){this.pos.y=0;this.vel.y*=-damping}};this.draw=function(){ctx.drawImage(image,this.pos.x,this.pos.y,diameter,diameter)}}function prepare(){delta=Date.now()-old;old=Date.now();ctx.clearRect(0,0,width,height);ctx.fillText(delta,fontWidth,height);for(var e=0;e<limit;e++){for(var t=e+1;t<limit;t++){if(b[e].pos.distance(b[t].pos)<lengthLimit){vec=b[e].pos.sub(b[t].pos);length=vec.length();if(length>lengthLimit){vec.div(Math.pow(length,3)/9);b[t].acl.add(vec);b[e].acl.isub(vec)}}}}update()}function update(){for(var e=0;e<b.length;e++){b[e].move()}draw()}function draw(){for(var e=0;e<b.length;e++){b[e].draw()}requestAnimFrame(prepare)}var canvas;var ctx;var width;var height;var damping;var radius;var speed;var limit;var b;var delta;var old;var fontWidth;var image;var diameter;var lengthLimit;var vec;var length;var Vector=function(e,t){this.x=e;this.y=t;this.sub=function(e){return new Vector(this.x-e.x,this.y-e.y)};this.isub=function(e){this.x-=e.x;this.y-=e.y};this.add=function(e){this.x+=e.x;this.y+=e.y};this.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)};this.div=function(e){this.x/=e;this.y/=e};this.zero=function(){this.x=0;this.y=0};this.validate=function(){if(isNaN(this.x+this.y)){this.x=0;this.y=0}};this.distance=function(e){return Math.sqrt((e.x-this.x)*(e.x-this.x)+(e.y-this.y)*(e.y-this.y))}};requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)}}()